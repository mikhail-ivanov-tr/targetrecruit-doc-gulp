

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: test/shared.js | Shared Code Documentation</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 80px; height: 13px">
        
            <a href="https://targetrecruit.com" rel="noopener noreferrer" target="_blank">
                <img src="https://targetrecruit.com/wp-content/uploads/2022/07/TargetRecruit_logo_purple.png" width="100%" height="100%">
            </a>
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Shared Code Documentation</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
        <ol class="lnb-tab">
            <li id="api-tab">
                <a href="#"><h4>API</h4></a>
            </li>
            <li id="examples-tab">
                <a href="#"><h4>Examples</h4></a>
            </li>
        </ol>
    
    <h2>Main</h2><div class="lnb-examples hidden"><h3>Examples</h3><ul><li><a href="tutorial-jest-tests.html">Jest Tests</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="jest-tests_sub"></div></li></ul></div><div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="CustomElement.html">CustomElement</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="CustomElement_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="CustomElement.html#initialError">initialError</a></li><li><a href="CustomElement.html#initialErrorLabel">initialErrorLabel</a></li><li><a href="CustomElement.html#initialLoading">initialLoading</a></li><li><a href="CustomElement.html#label">label</a></li><li><a href="CustomElement.html#loading">loading</a></li><li><a href="CustomElement.html#loadingGlobal">loadingGlobal</a></li><li><a href="CustomElement.html#messages">messages</a></li><li><a href="CustomElement.html#messagesGlobal">messagesGlobal</a></li><li><a href="CustomElement.html#ready">ready</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="CustomElement.html#addError">addError</a></li><li><a href="CustomElement.html#addInfo">addInfo</a></li><li><a href="CustomElement.html#addSuccess">addSuccess</a></li><li><a href="CustomElement.html#addWarning">addWarning</a></li><li><a href="CustomElement.html#apex">apex</a></li><li><a href="CustomElement.html#closeWindow">closeWindow</a></li><li><a href="CustomElement.html#renderedOnceCallback">renderedOnceCallback</a></li></ul></div></li><li><a href="Messages.html">Messages</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Messages_sub"></div></li><li><span class="icon green">LWC</span>&nbsp;<a href="UploadFiles.html">UploadFiles</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="UploadFiles_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="UploadFiles.html#extensions">extensions</a></li><li><a href="UploadFiles.html#helpText">helpText</a></li><li><a href="UploadFiles.html#label">label</a></li><li><a href="UploadFiles.html#multiple">multiple</a></li><li><a href="UploadFiles.html#required">required</a></li><li><a href="UploadFiles.html#type">type</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="UploadFiles.html#checkValidity">checkValidity</a></li><li><a href="UploadFiles.html#hasErrorMessage">hasErrorMessage</a></li><li><a href="UploadFiles.html#reportValidity">reportValidity</a></li><li><a href="UploadFiles.html#setCustomValidity">setCustomValidity</a></li></ul><div class="member-type">Events</div><ul class="inner"><li><a href="UploadFiles.html#event:upload">upload</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Mixins</h3><ul><li><a href="CustomInput.html">CustomInput</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="CustomInput_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="CustomInput.html#.controlClass">controlClass</a></li><li><a href="CustomInput.html#.helpMessage">helpMessage</a></li><li><a href="CustomInput.html#.required">required</a></li><li><a href="CustomInput.html#.value">value</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="CustomInput.html#.checkValidity">checkValidity</a></li><li><a href="CustomInput.html#.hasErrorMessage">hasErrorMessage</a></li><li><a href="CustomInput.html#.reportValidity">reportValidity</a></li><li><a href="CustomInput.html#.setCustomValidity">setCustomValidity</a></li><li><a href="CustomInput.html#.validate">validate</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Global</h3><ul><li class="hidden"><a href="global.html#Message">Message</a></li><li><a href="global.html#Severity">Severity</a></li></ul></div><h2>Testing</h2><div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="JestHtmlElement.html">JestHtmlElement</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="JestHtmlElement_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="JestHtmlElement.html#.dispatch">dispatch</a></li><li><a href="JestHtmlElement.html#.listen">listen</a></li><li><a href="JestHtmlElement.html#.query">query</a></li><li><a href="JestHtmlElement.html#.queryAll">queryAll</a></li></ul></div></li><li><a href="SharedTestHelpers.html">SharedTestHelpers</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="SharedTestHelpers_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="SharedTestHelpers.html#.staticData">staticData</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="SharedTestHelpers.html#.apexMock">apexMock</a></li><li><a href="SharedTestHelpers.html#.createComponent">createComponent</a></li><li><a href="SharedTestHelpers.html#.flushPromises">flushPromises</a></li><li><a href="SharedTestHelpers.html#.getMessages">getMessages</a></li></ul></div></li><li><a href="SharedTestHelpers.Timer.html">Timer</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="SharedTestHelpers.Timer_sub"></div></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * The module to be used for [Jest]{@link https://jestjs.io/docs/getting-started} tests. Use it to test Lightning Web Components.
 * */

import {createElement} from 'lwc';
import CustomElement from "c/customElement";

/**
 * @section Testing
 * @class JestHtmlElement
 * @hideconstructor
 * @extends HTMLElement
 */

/**
 * @name query
 * @function
 * @memberOf JestHtmlElement
 * @param selector
 * @returns {Promise&lt;JestHtmlElement>}
 */
HTMLElement.prototype.query = async function(selector) {
	await flushAllPromises();

	return this.shadowRoot.querySelector(selector);
};

/**
 * @name queryAll
 * @function
 * @memberOf JestHtmlElement
 * @param selector
 * @returns {Promise&lt;JestHtmlElement[]>}
 */
HTMLElement.prototype.queryAll = async function(selector) {
	await flushAllPromises();
	
	return Array.from(this.shadowRoot.querySelectorAll(selector));
};

/**
 * @name listen
 * @function
 * @memberOf JestHtmlElement
 * @param eventName
 * @returns {Mock}
 */
HTMLElement.prototype.listen = function (eventName) {
	const mockFunction = jest.fn();
	this.addEventListener(eventName, mockFunction);
	return mockFunction;
};

/**
 * Sends an Event to the object, (synchronously) invoking the affected EventListeners
 * in the appropriate order. This is a wrapper of EventTarget.dispatchEvent()
 * designed for Jest tests which combines an event creation and dispatch operation.
 * @name dispatch
 * @function
 * @memberOf JestHtmlElement
 * @param type A string with the name of the event. It is case-sensitive.
 * @param options An object that can have the following properties: "bubbles", "cancelable",
 * "composed", "detail". Also, it can contain additional properties, like "dataTransfer"
 * for "drop" event, which will be available in the event object in the listeners.
 * @returns {Promise&lt;void>}
 */
HTMLElement.prototype.dispatch = async function (type, options = {}) {
	const initOptions = [`bubbles`, `cancelable`, `composed`, `detail`];
	
	let init = {};
	for (const initOption of initOptions) {
		init[initOption] = options[initOption];
	}
	
	let event = new CustomEvent(type, init);
	for (let [name, value] of Object.entries(options)) {
		if (!initOptions.includes(name)) {
			event[name] = value;
		}
	}
	
	this.dispatchEvent(event);
	
	await flushAllPromises();
};

async function flushAllPromises() {
	for (let i = 0; i &lt; 2; i++) {
		await flushPromises();
	}
}

/**
 * @section Testing
 * @class SharedTestHelpers
 * @hideconstructor
 */

/**
 *
 * @memberOf SharedTestHelpers
 * @param componentName
 * @param componentClass
 * @param attributes
 * @returns {Promise&lt;JestHtmlElement>}
 * */
async function createComponent(componentName, componentClass, attributes = null) {
	const element = createElement(componentName, {
		is: componentClass
	});
	
	if (attributes) {
		Object.assign(element, attributes);
	}
	
	document.body.appendChild(element);
	
	await flushAllPromises();
	
	return element;
}

/**
 * NOTE: This function will work correctly only if you use for Apex calls
 * the CustomElement#apex function.
 *
 * @memberOf SharedTestHelpers
 * @param action
 * @param apexCallResult
 * @param componentClass
 * @returns {Mock}
 */
function apexMock(action, apexCallResult = {}, componentClass) {
	const mock = CustomElement.apexMock(action, componentClass);
	mock.mockResolvedValue(apexCallResult);
	return mock;
}

/**
 * @memberOf SharedTestHelpers
 * @param {Severity} severity
 * @returns {Message[]}
 */
function getMessages(severity = null) {
	return CustomElement.getMessages(severity);
}

/**
 * @memberOf SharedTestHelpers
 * @type {Object}
 */
const staticData = CustomElement.staticData;

/**
 * @section Testing
 * @memberOf SharedTestHelpers
 */
class Timer {
	constructor() {
		this.startTime = Math.trunc(performance.now());
	}
	
	getMilliseconds() {
		return Math.trunc(performance.now()) - this.startTime;
	}
}

/**
 * @memberOf SharedTestHelpers
 * @returns {Promise}
 */
const flushPromises = () => new Promise(resolve => {
	(typeof setImmediate === 'function' ? setImmediate : setTimeout)(resolve);
});

export {
	createComponent,
	Timer,
	apexMock,
	staticData,
	getMessages,
	flushPromises};
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="https://targetrecruit.com/wp-content/uploads/2022/07/TargetRecruit_logo_purple.png" style="width: 80px; height: 13px">
    <div class="footer-text">2022</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
